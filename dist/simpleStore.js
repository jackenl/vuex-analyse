/*! For license information please see simpleStore.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SimpleStore=t():e.SimpleStore=t()}(self,(function(){return(()=>{"use strict";var __webpack_modules__={"./simple-store/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   "Store": () => (/* reexport safe */ _store__WEBPACK_IMPORTED_MODULE_0__.Store),\n/* harmony export */   "install": () => (/* reexport safe */ _store__WEBPACK_IMPORTED_MODULE_0__.install)\n/* harmony export */ });\n/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./store */ "./simple-store/store.js");\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  Store: _store__WEBPACK_IMPORTED_MODULE_0__.Store,\n  install: _store__WEBPACK_IMPORTED_MODULE_0__.install\n});\n\n\n//# sourceURL=webpack://SimpleStore/./simple-store/index.js?')},"./simple-store/module.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (/* binding */ Module)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ "./simple-store/utils.js");\n\nclass Module {\n  constructor(options) {\n    const {\n      state,\n      getters,\n      mutations,\n      actions\n    } = options;\n    this.state = typeof state === \'function\' ? state() : state;\n    this.getters = getters;\n    this.mutations = mutations;\n    this.actions = actions;\n  }\n\n  forEachGetter(fn) {\n    if (this.getters) {\n      (0,_utils__WEBPACK_IMPORTED_MODULE_0__.forEachValue)(this.getters, fn);\n    }\n  }\n\n  forEachMutation(fn) {\n    if (this.mutations) {\n      (0,_utils__WEBPACK_IMPORTED_MODULE_0__.forEachValue)(this.mutations, fn);\n    }\n  }\n\n  forEachAction(fn) {\n    if (this.actions) {\n      (0,_utils__WEBPACK_IMPORTED_MODULE_0__.forEachValue)(this.actions, fn);\n    }\n  }\n\n}\n\n//# sourceURL=webpack://SimpleStore/./simple-store/module.js?')},"./simple-store/store.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "Store": () => (/* binding */ Store),\n/* harmony export */   "install": () => (/* binding */ install)\n/* harmony export */ });\n/* harmony import */ var _module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./module */ "./simple-store/module.js");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./simple-store/utils.js");\n\n\nlet Vue;\nclass Store {\n  constructor(options) {\n    this._mutations = Object.create(null);\n    this._actions = Object.create(null);\n    this._wrappedGetters = Object.create(null);\n    this._root = new _module__WEBPACK_IMPORTED_MODULE_0__.default(options);\n    const store = this;\n    const {\n      commit,\n      dispatch\n    } = this;\n\n    this.commit = function boundCommit(type, payload) {\n      return commit.call(store, type, payload);\n    };\n\n    this.dispatch = function boundDispatch(type, payload) {\n      return dispatch.call(store, type, payload);\n    };\n\n    const state = this._root.state;\n    installStore(store);\n    resetStoreVM(store, state);\n  }\n\n  get state() {\n    return this._vm._data.$$state;\n  }\n\n  set state(v) {\n    throw new Error(\'please use store.replaceState() to replace store state.\');\n  }\n\n  replaceState(state) {\n    this._vm._data.$$state = state;\n  }\n\n  commit(type, payload) {\n    const entry = this._mutations[type];\n\n    if (!entry) {\n      return;\n    }\n\n    entry.forEach(handler => handler(payload));\n  }\n\n  dispatch(type, payload) {\n    const entry = this._actions[type];\n\n    if (!entry) {\n      return;\n    }\n\n    const result = entry.length > 1 ? Promise.all(entry.map(handler => handler(payload))) : entry[0](payload);\n    return new Promise((resolve, reject) => {\n      result.then(res => {\n        resolve(res);\n      }).catch(err => {\n        reject(err);\n      });\n    });\n  }\n\n}\n\nfunction installStore(store) {\n  const root = store._root;\n  root.forEachMutation((mutation, key) => {\n    const entry = store._mutations[key] || (store._mutations[key] = []);\n    entry.push(function mutationHandler(payload) {\n      mutation.call(store, store.state, payload);\n    });\n  });\n  root.forEachAction((action, key) => {\n    const entry = store._actions[key] || (store._actions[key] = []);\n    entry.push(function actionHandler(payload) {\n      let res = action.call(store, {\n        dispatch: store.dispatch,\n        commit: store.commit,\n        getters: store.getters,\n        state: store.state\n      }, payload);\n\n      if (!(0,_utils__WEBPACK_IMPORTED_MODULE_1__.isPromise)(res)) {\n        res = Promise.resolve(res);\n      }\n\n      return res;\n    });\n  });\n  root.forEachGetter((getter, key) => {\n    if (store._wrappedGetters[key]) {\n      return;\n    }\n\n    store._wrappedGetters[key] = function getterHandler(store) {\n      return getter(store.state, store.getters);\n    };\n  });\n}\n\nfunction resetStoreVM(store, state) {\n  const oldVm = store._vm;\n  store.getters = {};\n  const wrappedGetters = store._wrappedGetters;\n  const computed = {};\n  (0,_utils__WEBPACK_IMPORTED_MODULE_1__.forEachValue)(wrappedGetters, (fn, key) => {\n    computed[key] = (0,_utils__WEBPACK_IMPORTED_MODULE_1__.partial)(fn, store);\n    Object.defineProperty(store.getters, key, {\n      get: () => store._vm[key],\n      enumerable: true\n    });\n  });\n  store._vm = new Vue({\n    data: {\n      $$state: state\n    },\n    computed\n  });\n\n  if (oldVm) {\n    Vue.nextTick(() => oldVm.$destroy());\n  }\n}\n\nfunction install(_Vue) {\n  if (Vue && _Vue === Vue) {\n    return;\n  }\n\n  Vue = _Vue;\n  Vue.mixin({\n    beforeCreate: storeInit\n  });\n}\n\nfunction storeInit() {\n  const options = this.$options;\n\n  if (options.store) {\n    this.$store = typeof options.store === \'function\' ? options.store() : options.store;\n  } else if (options.parent && options.parent.$store) {\n    this.$store = options.parent.$store;\n  }\n}\n\n//# sourceURL=webpack://SimpleStore/./simple-store/store.js?')},"./simple-store/utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "isPromise": () => (/* binding */ isPromise),\n/* harmony export */   "forEachValue": () => (/* binding */ forEachValue),\n/* harmony export */   "partial": () => (/* binding */ partial)\n/* harmony export */ });\nfunction isPromise(val) {\n  return val && typeof val.then === \'function\';\n}\nfunction forEachValue(obj, fn) {\n  Object.keys(obj).forEach(key => fn(obj[key], key));\n}\nfunction partial(fn, arg) {\n  return function () {\n    return fn(arg);\n  };\n}\n\n//# sourceURL=webpack://SimpleStore/./simple-store/utils.js?')}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./simple-store/index.js");return __webpack_exports__})()}));